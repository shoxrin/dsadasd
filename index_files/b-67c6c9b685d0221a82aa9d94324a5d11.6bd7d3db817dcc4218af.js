(self.webpackChunkvk=self.webpackChunkvk||[]).push([[7125],{35818:function(e,t,n){"use strict";n.d(t,{onOpen:function(){return l},onClose:function(){return c}});var a=999999,o=0,r=0,i=null,s=null;function l(e){void 0===e&&(e="default"),i&&(clearTimeout(i),i=null),s&&(clearTimeout(s),s=null),o=0,0,0,r=0,window.addEventListener("scroll",u),setTimeout((function(){scrollTo(0,a)}),10),setTimeout((function(){scrollTo(0,a)}),100),setTimeout((function(){scrollTo(0,a)}),200),setTimeout((function(){scrollTo(0,a)}),300),setTimeout((function(){scrollTo(0,a)}),400),setTimeout((function(){scrollTo(0,a)}),500)}function c(){clearTimeout(i),clearTimeout(s),o=0,0,0,i=null,s=null,window.removeEventListener("scroll",u)}function u(){var e=pageYOffset;e!==o&&e!==a&&(o=e,r=Math.max(r,e),scrollTo(0,a)),clearTimeout(s),s=setTimeout((function(){s=null,window.removeEventListener("scroll",u),scrollTo(0,a),setTimeout((function(){return scrollTo(0,a)}),1e3)}),150)}},36768:function(e,t,n){"use strict";n.d(t,{onOpen:function(){return s},onClose:function(){return l}});var a=n(28708),o=null,r=0,i=0;function s(){if(o||(o={onceBlocked:!1}),o.onceBlocked&&(o.opened=!0),!o.onceBlocked&&!o.opened){o.onceBlocked=!0;var e=document.activeElement;return e.blur(),e.focus(),!1}return o.opened=!0,window.visualViewport&&(r=visualViewport.height,i=0,setTimeout(c),visualViewport.addEventListener("scroll",c),visualViewport.addEventListener("resize",c)),!0}function l(){return!(!o||o.onceBlocked&&!o.opened)&&(window.visualViewport&&(setTimeout(c),visualViewport.removeEventListener("scroll",c),visualViewport.removeEventListener("resize",c)),o=null,r=0,i=0,!0)}function c(){if(!(visualViewport.height>=r)){var e=r-visualViewport.height;i!==e&&(!a.isWKWebView&&e<a.IOS_NO_KEYBOARD_ALLOWED_OFFSET?scrollTo(0,0):(a.iosMajor>=15&&(e+=a.IOS_15_BOTTOM_NAVBAR_OFFSET),scrollTo(0,e)))}}},80492:function(e,t,n){"use strict";n.d(t,{onOpen:function(){return b},onClose:function(){return w}});var a,o,r,i,s,l,c,u,d,h=n(28708),v=0,p=0,f="",_=!1,m={},g=0;function b(e){if(f=e,_=!1,a=!1,r=0,i=0,l=0,c=0,m={},void 0,u="start",d=0,g=0,h.isIPhone)if("top"===f||"bottom"===f){x()<h.IPHONE_KEYBOARD_REJECT_OFFSET&&P(0);var t=document.body;s=t.offsetHeight,t.offsetWidth,window.addEventListener("scroll",S),"top"===f&&(0,h.isLandscapePhone)()||(k(),M())}else document.body.classList.add("ScrollViewsDisabled")}function w(){"top"===f||"bottom"===f?(o&&clearTimeout(o),window.removeEventListener("scroll",S)):document.body.classList.remove("ScrollViewsDisabled"),_=!1,f="",a=!1,s=0,0}function S(){if(k(),"top"!==f){if("bottom"===f){var e=pageYOffset,t=x();a&&(a=!1,e===l)||(h.isWKWebView?c<=5&&M():e>h.IPHONE_KEYBOARD_REJECT_OFFSET?e>t?(P(e),h.isWKWebView||M()):e<t?m[e]||e>y(t)?(m[e]=!0,M(s)):M():e!==y(t)&&M():t||(e<h.IOS_NO_KEYBOARD_ALLOWED_OFFSET?(r===e?i++:(r=e,i=1),i>=3&&(window.removeEventListener("scroll",S),P(r)),setTimeout((function(){M()}),300)):M()))}}else{if((0,h.isLandscapePhone)())return;if(h.isWKWebView)return void(0!==pageYOffset&&M(0));var n=innerHeight;if("start"===u&&(n<s?u="animate":M(1)),"animate"===u)if(d=s-n,g||(g=Math.max(1,Math.min(4,Math.floor(d/10)))),d<=0)u="stop";else{var o=h.isIPad?h.iosMajor<11?3:2:1;M(Math.min(d,g)*o)}"stop"===u&&M(1)}}function M(e){a=!0;var t,n=x();"bottom"===f?t=e||(!n||h.isWKWebView||h.isIPad?s:y(n)):"top"===f&&(t=isFinite(e)?e:1),c++,l=t,window.scrollTo(0,t)}function k(){o&&clearTimeout(o),_||(o=setTimeout((function(){_=!0,o=null,window.removeEventListener("scroll",S)}),500))}function y(e){return h.isIPad||h.isWKWebView||90===Math.abs(window.orientation)&&screen.width>=375||(h.isIPhoneX?e-=h.IPHONE_X_SAFARI_BOTTOM_BAR:e-=h.IPHONE_SAFARI_BOTTOM_BAR),e}function x(){return 90===Math.abs(window.orientation)?v:p}function P(e){90===Math.abs(window.orientation)?v=e:p=e}},56399:function(e,t,n){"use strict";n.d(t,{onOpen:function(){return _},onClose:function(){return m},onCloseCallback:function(){return g},offCloseCallback:function(){return b},onOpenCallback:function(){return w}});var a=n(35818),o=n(80492),r=n(36768),i=n(28708),s=!1,l=!1,c=!1,u=null,d=[],h=[],v=null,p=i.isScrollBasedViewport&&(i.isIPad||i.isWKWebView),f=i.isScrollBasedViewport&&i.iosMajor<=12;function _(e,t){void 0===e&&(e="default");var n=(void 0===t?{}:t).exitIfStarted,c=void 0!==n&&n;if(i.isIOS&&!(i.iosMajor<8)&&!(l&&c||s)){if(v=e,l=!0,u&&(clearTimeout(u),u=null),"bottom"===e){if(((0,i.isLandscapePhone)()||!p&&!f)&&!r.onOpen())return;!p&&f&&o.onOpen(e),p&&a.onOpen()}else!p&&f&&o.onOpen(e);h.length&&h.forEach((function(e){return e()})),s=!0,l=!1}}function m(e){var t=(void 0===e?{}:e).exitIfStarted,n=void 0!==t&&t;if(i.isIOS&&!(i.iosMajor<8)&&(!c||!n)){if(c=!0,"bottom"===v){if(((0,i.isLandscapePhone)()||!p&&!f)&&!r.onClose())return;if(!s)return;!p&&f&&o.onClose(),p&&a.onClose()}else!p&&f&&o.onClose();s=!1,c=!1,v=null,u&&clearTimeout(u),u=setTimeout((function(){scrollTo(0,0),d.length&&d.forEach((function(e){return e()}))}),10)}}function g(e){-1===d.indexOf(e)&&d.push(e)}function b(e){var t=d.indexOf(e);-1!==t&&d.splice(t,1)}function w(e){-1===h.indexOf(e)&&h.push(e)}},42516:function(e,t,n){"use strict";n.d(t,{preventDocumentScroll:function(){return g},restoreDocumentScroll:function(){return b},setScrollView:function(){return y},cleanScrollView:function(){return x},hideTopBanner:function(){return W}});var a,o,r,i,s,l,c,u=n(1730),d=n(56399),h=n(28708),v=(n(86353),!0),p=!1,f="closed",_=!1,m=[];function g(e){void 0===e&&(e={}),h.isIOS&&(!0!==e.stack&&_||(c={initialized:!1,scrollViews:[]},m.push(c),e.layoutElement&&e.layoutElement.nodeType?c.layoutElement=e.layoutElement:c.layoutElement=(0,u.$)(e.layoutElement||".layout")),!1===e.topBanner?c.topBanner=!1:c.topBanner=!0,_||(_=!0,addEvent(window,"focusin",I),addEvent(window,"focusout",B),addEvent(document,"touchmove",A,{capture:!0}),addEvent(document,"touchmove",H,{capture:!1}),addEvent(window,"resize",T),d.onCloseCallback(V),h.isWKWebView||(addEvent(window,"orientationchange",C),requestAnimationFrame((function(){(0,h.isLandscapePhone)()?C(null,!0):(T(),c&&!c.topBanner?requestAnimationFrame(W):r||requestAnimationFrame(N))})))))}function b(){_&&(_=!1,w(),1===m.length&&(c.layoutOffset=null,F(),document.body.style.height=""),c.layoutElement=null,m.pop(),(c=m.length?m[m.length-1]:null)&&F(),removeEvent(window,"focusin",I),removeEvent(window,"focusout",B),removeEvent(document,"touchmove",A,{capture:!0}),removeEvent(document,"touchmove",H,{capture:!1}),removeEvent(window,"resize",T),removeEvent(window,"orientationchange",C),removeEvent(window,"resize",E),removeEvent(window,"scroll",L),d.offCloseCallback(V))}function w(){c.scrollViews.forEach((function(e){return x(e)})),c.scrollViews=[]}function S(e){var t=e.currentTarget.__ScrollView;if("prevented"!==t.state){if(!("start"!==t.state||t.allowX&&t.allowY)){var n=Math.abs(t.startX-e.changedTouches[0].clientX),a=Math.abs(t.startY-e.changedTouches[0].clientY);if(!t.allowX&&n>a)return void(t.state="prevented");if(!t.allowY&&a>n)return void(t.state="prevented")}if("allowed"!==t.state&&(t.state="allowed"),v=!1,!t.overscrollX){var o=e.currentTarget.scrollLeft,r=t.startX-e.changedTouches[0].clientX;(o<=0&&r<=0||o>=t.maxX&&r>=0)&&(v=!0,t.standalone&&e.preventDefault())}if(!t.overscrollY){var i=e.currentTarget.scrollTop,s=t.startY-e.changedTouches[0].clientY;(i<=0&&s<=0||i>=t.maxY&&s>=0)&&(v=!0,t.standalone&&e.preventDefault())}}}function M(e){var t=e.currentTarget,n=t.__ScrollView;n.state="start",n.startX=e.changedTouches[0].clientX,n.startY=e.changedTouches[0].clientY,n.maxX=n.overscrollX?null:t.scrollWidth-t.clientWidth,n.maxY=n.overscrollY?null:t.scrollHeight-t.clientHeight}function k(e){e.currentTarget.__ScrollView.state=""}function y(e,t){if(void 0===t&&(t={}),h.isIOS&&(!1!==t.override||!e.__ScrollView)){if(!0!==t.standalone){if(!_)return;e.__ScrollView||c.scrollViews.push(e)}e.__ScrollView={allowX:!1!==t.allowX,allowY:!1!==t.allowY,overscrollX:!1!==t.overscrollX,overscrollY:!1!==t.overscrollY,standalone:!0===t.standalone},c&&(h.isWKWebView||(!1!==t.topBanner&&(e.__ScrollView.topBanner=t.topBanner||{hide:30,show:60}),addEvent(e,"scroll",P))),addEvent(e,"touchstart",M),addEvent(e,"touchmove",S),addEvent(e,"touchend",k)}}function x(e){e.__ScrollView=null,removeEvent(e,"touchstart",M),removeEvent(e,"touchmove",S),removeEvent(e,"touchend",k),removeEvent(e,"scroll",P)}function P(e){if("closed"!==f||(0,h.isLandscapePhone)())return p=!1,void(i&&clearTimeout(i));p=!0;var t=e.target.__ScrollView.topBanner;c&&c.topBanner&&t?$(e.target,t.show,t.hide):$(e.target,1/0,0),i&&clearTimeout(i),i=setTimeout((function(){p=!1,T()}),100)}function T(){if(!p)if(l)l=!1;else if(!(0,h.isLandscapePhone)()){window.pageYOffset;"closed"===f&&(h.isWKWebView||(a=document.documentElement.offsetHeight,o=innerHeight,r=a===o,"show"===s?(s=null,requestAnimationFrame(N)):"hide"===s&&(s=null,requestAnimationFrame(W))))}}function C(e,t){h.isIPad?c.topBanner||setTimeout((function(){W()}),400):90===Math.abs(window.orientation)?(addEvent(window,"resize",E),document.body.style.height="",c.layoutHeight=null,t?setTimeout((function(){window.scrollTo(0,-300),E()})):setTimeout((function(){window.scrollTo(0,-300)}),400)):(removeEvent(window,"resize",E),c.layoutOffset=null,F(),c.topBanner||setTimeout((function(){W()}),400))}function E(){if("closed"===f){var e=document.body.offsetHeight,t=e-innerHeight;c.layoutOffset=t,F(),window.scrollTo(0,e)}}function L(){pageYOffset&&(f="opened",removeEvent(window,"scroll",L))}function A(e){v=!0}function H(e){v&&e.preventDefault()}function O(e){var t=e&&e.target,n=0===e.eventPhase&&t.getAttribute("autofocus"),a=!1;return"textarea"!==t.tagName.toLowerCase()||n||(a=!0),"input"!==t.tagName.toLowerCase()||["checkbox","radio","image","submit"].includes(t.type)||n||(a=!0),"select"===t.tagName.toLowerCase()&&(a=!0),a}function I(e){if(O(e)){e&&e.target;f="opening",addEvent(window,"scroll",L),d.onOpen(undefined,{exitIfStarted:!0})}}function B(e){O(e)&&d.onClose({exitIfStarted:!0})}function V(){removeEvent(window,"scroll",L),f="closed",setTimeout((function(){(0,h.isLandscapePhone)()?E():T()}),100)}function $(e,t,n){var a=e.scrollTop;a<=-t&&(r||s)?(s="show",window.scrollTo(0,-10)):a>=n&&(!r||s)&&(s="hide",window.scrollTo(0,10))}function W(){window.scrollTo(0,300)}function N(){window.setImmediate?setImmediate((function(){window.scrollTo(0,-300)})):window.scrollTo(0,-300)}function F(){var e=c.layoutOffset;c.layoutElement.style.top=e?e+"px":""}},4328:function(e,t,n){"use strict";var a=n(46950);t.default=function(e){return void 0===e&&(e={}),(0,a.extend)({inner:[e.text],class:["Textarea",e.mix],name:e.name,placeholder:e.placeholder,rows:e.rows?e.rows:3,maxlength:e.maxlength,tag:"textarea"},e.attrs)}},74977:function(e,t,n){"use strict";n.d(t,{initAutogrow:function(){return o}});var a=n(9046);function o(e,t){void 0===t&&(t=3);var n=(0,a.ce)("span",{className:"Textarea__ghost"});(0,a.setStyle)(n,{width:e.clientWidth+"px",padding:(0,a.getStyle)(e,"padding"),lineHeight:(0,a.getStyle)(e,"line-height")}),n.innerText="_",(0,a.append)(n,e.parentNode);var o=n.clientHeight;(0,a.addEvent)(e,"input",(function(){var r=e.value.replace(/ /g,"&nbsp;").replace(/\n/g,"<br />");("\n"===(0,a.last)(r)||r.endsWith("<br />"))&&(r+="&nbsp;"),n.innerHTML=r,e.rows=Math.max(1,Math.min(t,Math.ceil(n.clientHeight/o)))}))}},54543:function(e,t,n){"use strict";n.d(t,{initAutogrow:function(){return o.initAutogrow}});var a=n(4328),o=n(74977);t.default=a.default},66237:function(e,t,n){"use strict";n.d(t,{ContextMenu:function(){return r},ContextMenuItem:function(){return i}});var a=n(91687),o=n(86205);function r(e){return(0,a.default)({on_overlay_click:["return ContextMenu.close","this"],class:"ContextMenu",close:!0,onClose:["return ContextMenu.close","this"],items:[e.list?{tag:"ul",class:"ContextMenu__list",inner:e.withoutWrap?e.list:Wd.wrap(e.list)}:null]})}function i(e){return{inner:[e.icon?{inner:[(0,o.SVGIcon)({icon:e.icon})],class:"ContextMenu__listIcon",tag:"div"}:null,{inner:[e.title],attrs:e.attrs,"data-ref":e.ref,href:e.href,target:e.target,class:"ContextMenu__listLink",onClick:e.onclick,tag:"a"}],class:"ContextMenu__listItem","data-name":e.name,tag:"li"}}},22917:function(e,t,n){"use strict";var a=n(69756),o=n(1730),r={open:function(e,t,n){void 0===n&&(n={});var r;r=n.pureMenu?e:n.menuEl;if(!r){var l=e.closest(t);r=(0,o.$)(s,l)}if(r)return r=a.default.open(r,n.appendToBody||n.pureMenu,"",{withoutPopupCloning:n.withoutPopupCloning}),i=function(){c(r)},nav.onBeforeGo(i),r;return!1},close:c};t.default=r;var i=function(){},s=".ContextMenu",l=".ContextMenu.Popup_open";function c(e){return e||(e=(0,o.$)(".Popup_open.ContextMenu")||(0,o.$)(l)),e&&a.default.close(e),nav.onBeforeGo.off(i),!1}},89359:function(e,t,n){"use strict";n.d(t,{ContextMenu:function(){return o.ContextMenu},ContextMenuItem:function(){return o.ContextMenuItem}});var a=n(9046),o=n(66237),r=n(22917);(0,a.extend)(o.ContextMenu,r.default),t.default=o.ContextMenu,window.ContextMenu=o.ContextMenu},69756:function(e,t,n){"use strict";n.d(t,{ModalMenuBtn:function(){return s},ModalMenuContent:function(){return h},ModalMenuIcon:function(){return l},ModalMenuTitle:function(){return u},ModalMenuBody:function(){return c},ModalMenuHeaderCloseButton:function(){return d}});var a=n(61124),o=n(49751),r=n(46950),i=n(35909);function s(e){var t;return t=e.isBtn?(0,r.classNames)(e.class||e.className,"ModalMenu__btn","ModalMenu__customBtn"):(0,r.classNames)(e.class||e.className,"ModalMenu__btn","ModalMenu__item"),(0,o.default)({icon:e.icon,url:e.url,class:t,theme:e.theme?e.theme:"none",size:e.size?e.size:"",inner:e.inner,on_click:e.onclick,use_native_onclick:!0,attrs:e.attrs,"aria-label":e["aria-label"]||""})}function l(e){return{inner:[{inner:[e.inner],class:"ModalMenu__icon",tag:"div"}],class:"ModalMenu__iconWrapper",tag:"div"}}function c(e){return{inner:[e.inner],class:"ModalMenu__customBody",tag:"div"}}function u(e){return{inner:[e.inner],class:"ModalMenu__title",tag:"div"}}function d(e){return void 0===e&&(e={}),{inner:[(0,i.Icon24Dismiss)()],class:"ModalMenu__headerCloseButton",onClick:e.onClose?e.onClose:["ModalMenu.close","this"],"aria-label":(0,r.getLang)("mobile_close"),tag:"button"}}function h(e){return e.class+=" ModalMenuContent",e}t.default=function(e){var t=e.attached?"ModalMenu--attached":"",n=[];if(e.title&&n.push({class:"ModalMenu__title",inner:e.title}),e.body&&n.push({class:"ModalMenu__body",inner:e.body}),(0,r.isArray)(e.items)){var i=e.items.map((function(e){return e}));n.push(i)}e.close&&n.push((0,o.default)({class:"ModalMenu__btn ModalMenu__cancel",theme:"secondary",size:"large",inner:e.closeText?e.closeText:(0,r.getLang)("mobile_cancel"),on_click:e.onClose?e.onClose:["ModalMenu.close","this"],use_native_onclick:!0}));var s=function(e){if(e&&e[0]&&e[0].inner&&e[0].inner.inner&&e[0].inner.inner[0]&&"ModalMenuHeader"===e[0].inner.inner[0].class)return!0;return!1}(n)?" ModalMenu--hasHeader":"";return(0,a.default)({id:e.id||"",class:"ModalMenu "+e.class+" "+t+" "+s,on_overlay_click_native:e.on_overlay_click?e.on_overlay_click:["ModalMenu.close","this"],content:n})}},90466:function(e,t,n){"use strict";n.d(t,{open:function(){return T},close:function(){return L}});var a,o,r,i=n(61124),s=n(1730),l=n(94490),c=n(22770),u=n(9046),d=n(45029),h="horizontal",v="vertical",p=882,f=!1,_=null,m=null,g=0,b=0,w=0,S={},M=null,k=(0,s.$)(".Popup__wrap",a),y=!1,x=!1,P=0;function T(e,t,n,l){void 0===t&&(t=!0),void 0===n&&(n=""),void 0===l&&(l={});var d=l,h=d.settling,v=void 0===h?75:h,f=d.expandable,_=void 0!==f&&f;if(l.settling=v,l.expandable=_,a=i.default.open(e,t,{hash:n,withoutCloning:l.withoutPopupCloning}),S=l,k=(0,s.$)(".Popup__wrap",a),r=(0,s.$)(".Popup__content",k),void 0===l.swipeDown&&(l.swipeDown=!0),_&&E(a)){a.classList.add("ModalMenu--expandable");var m=(100-S.settling)/100*window.innerHeight;P=m,u.setStyle.animate(k,"transform",{duration:200,func:"ease"}),u.setStyle.transform(k,1,[0,m])}return B(),(0,u.onBodyResize)(B),l.swipeDown&&window.innerWidth<p&&(scrollTop(0),(0,u.addEvent)(r,"touchstart",A,{passive:!0}),(0,u.addEvent)(r,"touchmove",H,{capture:!0}),(0,u.addEvent)(r,"touchcancel touchend",O,{passive:!0}),(0,u.addEvent)(k,"click",C,{passive:!0}),(0,u.addEvent)(k,"click",C,{passive:!0})),(o=(0,c.setFocusTrap)(a))&&(o.exitIntent=function(){return!1}),a}function C(e){if(k&&e.target===k)return(o=(0,c.setFocusTrap)(a))&&(o.exitIntent=function(){return!1}),a}function E(e){var t=(0,s.$)(".ModalMenu__body",e)||(0,s.$)(".ModalMenuContent",e)||(0,s.$)(".Popup__content",e);return!((0,u.getCw)()>=p)&&(t.scrollHeight||(0,u.getH)(t))>=window.innerHeight}function L(e,t){if(void 0===t&&(t={}),e||(e=document.activeElement),e){var n=e.closest(".ModalMenu.Popup_open")||e;n&&n.classList.contains("ModalMenu")&&(e.classList.contains("Popup__overlay")&&(0,d.isFunction)(S.onOverlayClick)&&S.onOverlayClick(),window.innerWidth<p?i.default.close(n,{smooth:!0,velocity:!(!M||!M.velocity)&&M.velocity,lastY:w,onClose:t.onClose}):setTimeout((function(){i.default.close(n),t.onClose&&t.onClose()})),(0,u.removeEvent)(r,"touchstart",A,{passive:!0}),(0,u.removeEvent)(r,"touchmove",H,{capture:!0}),(0,u.removeEvent)(r,"touchcancel touchend",O,{passive:!0}),(0,u.removeEvent)(k,"click",C,{passive:!0}),(0,u.removeEvent)(k,"click",C,{passive:!0}),m=null,g=0,b=0,_=null,x=!1,w=0,P=0,a=Array.from((0,s.$$)(".ModalMenu.Popup_open")).pop(),k=(0,s.$)(".Popup__wrap",a),r=(0,s.$)(".Popup__content",k),M=null,S={},(0,u.onBodyResize)("__clear",B),o&&(o(),o=null))}}function A(e){if(e.touches&&e.touches.length>1)f=!1;else{var t=e.target.closest(".ScrollView")||(0,s.$)(".ScrollView",e.target);if(!(0,s.$)(".ModalMenu").classList.contains("ModalMenu--blocked")){var n=S.expandable&&E(a);y=n,m=e.touches[0],b=e.touches[0].clientX,g=e.touches[0].clientY,t&&t.scrollTop>1?f=!1:(M=new l.Gesture({time:e.timeStamp,x:e.touches[0].clientX,y:e.touches[0].clientY}),f=!0)}}}function H(e){if(e.touches&&e.touches.length>1)f=!1;else if(m&&f){var t=e.touches[0];if(_||(_=Math.abs(b-t.clientX)>Math.abs(g-t.clientY)?h:v),_!==h){M.registerEvent(e);var n=-Math.min(0,g-t.clientY-P);0!==n&&((0,u.cancelEvent)(e),w=n,x||(a.classList.add("ModalMenu--dragging"),browser.ios&&u.setStyle.animate(k,"transform",{duration:50,func:"linear"}),x=!0),I(n),u.setStyle.transform(k,1,[0,n]))}}}function O(e){if(f)if(f=!1,a.classList.remove("ModalMenu--dragging"),x=!1,_!==h){_=null,I(w);var t=S.expandable&&E(a);y=t;var n=a.classList.contains("ModalMenu--expanded"),o=!n,r=function(e){void 0===e&&(e=[]);return e.find((function(e){return 0!==e.scrollTop||e.scrollHeight>e.offsetHeight}))}(e.path),i=!1;r&&(i=0!==r.scrollTop);var s=!1,l=!1;M&&(s=!i&&M.velocity.y>=.6,l=!i&&M.velocity.y<=-.15);var c=w/window.innerHeight*100,d="";n?d="expand":o&&(d="collapse");var v=d;s&&c<8?c=8:l&&(c=0),!t&&c>=8||c>=100-S.settling+8?v="close":n?c>=8&&!i&&(v="collapse"):o&&E(a)&&c<=100-S.settling&&(v="expand"),function(e){if(!e)return;a.classList.toggle("ModalMenu--expanded","expand"===e),"close"!==e&&k.style.removeProperty("transition");switch(e){case"collapse":a.classList.add("ModalMenu--restore");var t=0;E(a)&&(t=(100-S.settling)/100*window.innerHeight),P=t,u.setStyle.transform(k,1,[0,t]),I(P=t,!0),setTimeout((function(){a&&a.classList.remove("ModalMenu--restore"),0===t&&(0,u.setStyle)(k,{transform:""})}),200);break;case"expand":a.classList.add("ModalMenu--restore"),a.classList.add("ModalMenu--expanded"),u.setStyle.transform(k,1,[0,0]),I(P=0,!0),setTimeout((function(){a&&(B(),a.classList.remove("ModalMenu--restore"))}),200);break;case"close":P=0,L(a,S)}}(v),M=null}else _=null}function I(e,t){if(void 0===e&&(e=null),void 0===t&&(t=!1),y){var n=(0,s.$)(".ModalMenuHeader__title",k),a=(0,s.$)(".ModalMenuHeader__close",k);if(n&&a){var o=(100-S.settling)/100*window.innerHeight,r=1-Math.max(0,Math.min(1,(null===e?P:e)/o));t&&(u.setStyle.animate(n,"transform",{duration:250}),u.setStyle.animate(a,"transform, opacity",{duration:250})),u.setStyle.transform(n,1,[44*r,0]),u.setStyle.transform(a,r),(0,u.setStyle)(a,{opacity:r})}}}function B(){var e=(0,s.$)(".ModalMenuContent",a),t=(0,s.$)(".ModalMenuHeader",a);if(e&&t){var n=(0,u.getH)(t),o=(0,u.getH)(e),r=Math.min((0,u.getCh)(),o+n+"px");(0,u.getCw)()>=p&&(r=null),(0,u.setStyle)(e,"height",r)}}(0,u.addEvent)(window,"keydown",(function(e){var t=e.target&&e.target.closest(".ModalMenu")||document.activeElement&&document.activeElement.closest(".ModalMenu")||(0,s.$)(".ModalMenu.Popup_open");if(t)switch(e.keyCode){case 27:L(t,S)}})),(0,u.addEvent)(window,"click",(function(e){if(e.isTrusted){var t=e.target&&e.target.closest(".ModalMenu")||document.activeElement&&document.activeElement.closest(".ModalMenu")||(0,s.$)(".ModalMenu.Popup_open"),n=!!e.target.closest(".ModalMenu");if(t&&n&&!e.target.closest(".Popup__content")){var a=(0,s.$)(".Popup__overlay",t);window.clog("Simulate modal overlay click"),a.click()}}}),{passive:!0})},91687:function(e,t,n){"use strict";n.d(t,{open:function(){return r.open},close:function(){return r.close},ModalMenuBtn:function(){return o.ModalMenuBtn},ModalMenuTitle:function(){return o.ModalMenuTitle},ModalMenuBody:function(){return o.ModalMenuBody},ModalMenuHeaderCloseButton:function(){return o.ModalMenuHeaderCloseButton}});var a=n(9046),o=n(69756),r=n(90466);t.default=o.default,(0,a.extend)(o.default,{open:r.open,close:r.close}),window.ModalMenu=o.default},32128:function(e,t,n){"use strict";var a=n(86205),o=n(54543),r=n(81755),i=n(49751),s=n(46950),l=n(35909),c=n(53851),u=n(64952),d=n(93420),h=n(83652),v=n(16854),p=n(73079),f=n(42097);function _(e){return void 0===e&&(e={}),{class:"SharePanel SharePanel-header SharePanel--active ShareHeaderConversationsPanel","aria-hidden":"false","data-name":"ShareHeaderConversationsPanel",inner:[{"aria-label":(0,s.getLang)("mobile_close"),onclick:"cur.share && cur.share.destroy()",role:"button",class:"SharePanel-header__close",inner:(0,l.Icon24Cancel)()},{class:"SharePanel-headerText",inner:[{class:"SharePanel-headerText__label",inner:(0,s.getLang)("mobile_like_publish_head_title")},{class:"SharePanel-headerText__receivers"}]},{class:"SharePanel-headerRight",inner:[{"aria-label":(0,s.getLang)("mobile_search"),class:"SharePanel-headerRight__search",role:"button",inner:(0,l.Icon24Search)(),onclick:"cur.share.toggleConversationsSearch(true)"},e.supportsExternalShare?{"aria-label":(0,s.getLang)("mobile_share_external"),class:"SharePanel-headerRight__externalShare",role:"button",inner:"iOS"===e.platform?(0,a.default)((0,c.getShareExternalIos24Icon)()):(0,a.default)((0,u.getShareExternalAndroid24Icon)()),onclick:"cur.share.externalShare()"}:null]}]}}function m(e){var t=e.buttons,n=e.options,a="boolean"!=typeof e.active||e.active;return{class:"ActionsPanel SharePanel "+(a?"SharePanel--active":""),"data-name":"ActionsPanel","aria-hidden":!a,style:!(n.can_to_own||n.can_to_club||n.can_bookmark)?"display: none;":"",inner:t.map((function(e){if(e)return function(e){var t=e.href?"a":"div",n=e.onclick,a={tag:t,role:"button",tabindex:-1,href:e.href,onclick:n,class:"ActionsPanel-button ActionsPanel-button--"+e.target,inner:[{class:"ActionsPanel-button__icon",inner:e.icon},{class:"ActionsPanel-button__label",inner:e.label}]};"boolean"==typeof e["aria-pressed"]&&(a["aria-pressed"]=e["aria-pressed"]+"");return a}(e)}))}}t.default=function(e){var t=e.can_bookmark,n=e.is_bookmarked,c=e.object,u=e.list,g=e.from,b=e.post_from,w=e.supportsExternalShare,S=e.isVKApp,M=e.targetOwnOnClick,k=(0,s.makeUrl)("/wall",{act:"add",share_box:1,is_vk_app:S,object:c,list:u,from:g,post_from:b}),y="cur.share.go('"+k+"')";return"function"==typeof M?y="cur.share.toOwnWall()":Array.isArray(M)?y=M:"string"==typeof M&&(y=[M,"event",k]),{inner:[{inner:[_({platform:e.platform,supportsExternalShare:w}),{class:"SharePanel ShareHeaderSearch ShareHeaderConversationsSearchPanel","aria-hidden":"true","data-name":"ShareHeaderConversationsSearchPanel",role:"search",inner:(0,r.default)({disabled:!0,autocomplete:!1,onblur:'cur.share.clearSearch(event, "peers", true)',prefix:{text:{role:"button",inner:(0,l.Icon16SearchOutline)()}},postfix:{text:{class:"ShareHeaderSearch__clear",role:"button",onclick:'cur.share.clearSearch(event, "peers")',inner:(0,l.Icon24CancelOutline)()}},class:"ShareHeaderConversationsSearchPanel__input",id:"ShareHeaderConversationsSearchPanel__input",placeholder:(0,s.getLang)("mobile_search"),spellcheck:!1})},{class:"SharePanel SharePanel-header ShareHeaderGroupsPanel","aria-hidden":"true","data-name":"ShareHeaderGroupsPanel",inner:[{"aria-label":(0,s.getLang)("mobile_back"),onclick:"cur.share.toggleGroupsPanel(false)",role:"button",class:"SharePanel-header__close",inner:(0,l.Icon24Back)()},{class:"SharePanel-headerText",inner:[{class:"SharePanel-headerText__label",inner:(0,s.getLang)("mobile_like_publish_head_title")}]},{class:"SharePanel-headerRight",inner:[{class:"SharePanel-headerRight__search",role:"button",inner:(0,l.Icon24Search)(),onclick:'cur.share.setActivePanel(this, "ShareHeaderGroupsSearchPanel", true)'}]}]},{class:"SharePanel ShareHeaderSearch ShareHeaderGroupsSearchPanel","aria-hidden":"true","data-name":"ShareHeaderGroupsSearchPanel",role:"search",inner:(0,r.default)({disabled:!0,autocomplete:!1,onblur:'cur.share.clearSearch(event, "group", true)',prefix:{text:{"aria-label":(0,s.getLang)("mobile_search"),role:"button",inner:(0,l.Icon16SearchOutline)()}},postfix:{text:{class:"ShareHeaderSearch__clear",onclick:'cur.share.clearSearch(event, "group")',inner:(0,l.Icon24CancelOutline)()}},class:"ShareHeaderGroupsSearchPanel__input",id:"ShareHeaderGroupsSearchPanel__input",placeholder:(0,s.getLang)("mobile_search"),spellcheck:!1})}],class:"SharePanelRoot ShareHeader",tag:"header"},{id:"Share__input",style:"display: none;",tag:"input"},{inner:[{class:"ShareConversations SharePanel SharePanel--active filter_peer_wrap","data-name":"ShareConversations","aria-hidden":"false",role:"group",id:"ShareConversations"},{class:"ShareGroups SharePanel","data-name":"ShareGroups","aria-hidden":"true",role:"group",id:"ShareGroups"}],class:"SharePanelRoot ShareLists",tag:"section"},{inner:[m({active:!0,options:e,buttons:[e.can_to_own?{target:"own",label:(0,s.getLang)("mobile_share_target_own"),onclick:y,icon:(0,a.default)((0,v.getArrowUturnRightOutline28Icon)())}:null,e.can_to_club?{target:"group",label:(0,s.getLang)("mobile_share_target_group"),icon:(0,l.Icon28UsersOutline)()}:null,t?{target:"bookmark","aria-pressed":n,label:n?(0,s.getLang)("mobile_share_target_bookmark_active"):(0,s.getLang)("mobile_share_target_bookmark"),icon:(0,a.default)(e.is_bookmarked?(0,p.getFavorite28Icon)():(0,f.getFavoriteOutline28Icon)())}:null]}),{class:"SharePanel MessagePanel","aria-hidden":"true","data-name":"MessagePanel",inner:[(0,r.default)({tabindex:-1,autocomplete:!1,class:"MessagePanel__input",on_click:["cur.share.expandMessage"],placeholder:(0,s.getLang)("mobile_share_message_placeholder"),spellcheck:!1,readonly:!0,disabled:!0}),(0,i.default)({stretch:!0,size:"large",inner:(0,s.getLang)("mobile_share_message_single"),on_click:"cur.share.sendMessage(event)",use_native_onclick:!0})]},{class:"SharePanel ExpandedMessagePanel","aria-hidden":"true","data-name":"ExpandedMessagePanel",inner:[{class:"ExpandedMessagePanel__textareaWrap",inner:[(0,o.default)({placeholder:(0,s.getLang)("mobile_share_message_placeholder"),rows:1}),{class:"ExpandedMessagePanelSend",inner:(0,a.default)((0,d.getSendActive24Icon)())}]}]},{class:"SharePanel ProcessingPanel","aria-hidden":"true","data-name":"ProcessingPanel",inner:[{class:"ProcessingPanel__icon ProcessingPanel__icon--loading",inner:(0,a.default)((0,h.getLoading40Icon)())},{class:"ProcessingPanel__label",inner:(0,s.getLang)("mobile_share_state_progress")}]}],class:"SharePanelRoot ShareBottom",tag:"footer"}],class:"Share",role:"dialog","aria-label":(0,s.getLang)("mobile_like_publish_head_title"),hidden:"false",tabindex:"-1",tag:"div"}}},76470:function(e,t,n){"use strict";n.d(t,{setBookmarkState:function(){return J}});var a=n(91687),o=n(89359),r=n(32128),i=n(86205),s=n(39423),l=n(54543),c=n(42516),u=n(9046),d=n(46950),h=n(3226),v=n(84006),p=n(1730),f=n(80444),_=n(56399),m=n(28708),g=n(54412),b=n(11539),w=n(35909),S=n(68969),M=n(96364),k=n(40469),y=n(80540),x="/hints?act=a_json_friends&mobile=1&from=imwrite&case=Nom&qs=1",P="ShareConversations",T="ShareGroups",C=x+P,E=0,L=!1,A={bookmarks:{}};function H(e){var t=window.cur.module;return e.startsWith("photo")&&window.photo.isZOpened()&&(t="photo_viewer"),t}function O(e){B(e)}function I(e){var t;nav.go(e),null==(t=cur.share)||t.destroy({isNavigation:!0})}function B(e){if(cur.share){var t=cur.share._els.header,n=e.scrollTop;t.classList.toggle("ShareHeader--scrolled",n>=10)}}function V(e,t,n){if(!cur.share||cur.share.blocked)return!1;if(W(!0),(0,u.cancelEvent)(n),(0,u.hasClass)("inline_item_selected",t))return cur.shareSearch.toggleAttach(e,!1),function(e,t){for(var n=0;n<cur.share.selected.length;n++)if(cur.share.selected[n]===e){cur.share.selected.splice(n,1);break}return j(!1),R(),!1}(e);cur.shareSearch.toggleAttach(e,!0);for(var a=!1,o=0;o<cur.share.selected.length;o++)if(cur.share.selected[o]===e){a=!0;break}return a||cur.share.selected.push(e),W(!1),j(!1),R(),!1}function $(e,t,n){if(cur.share&&!cur.share.blocked){e=e.closest(".SharePanelRoot");var a,o=(0,p.$$)(".SharePanel",e);t&&(a=(0,p.$)("."+t,e)),o.forEach((function(e){var t=e===a;e.setAttribute("aria-hidden",!t),e.classList.toggle("SharePanel--active",t),t?e.removeAttribute("tabindex"):e.setAttribute("tabindex",-1),(0,p.$$)("input, ul",e).forEach((function(e){e.setAttribute("aria-hidden",!t);var n=e.closest(".TextInput");t?(null==n||n.classList.remove("TextInput_disabled"),e.removeAttribute("disabled"),e.setAttribute("tabindex",0)):(null==n||n.classList.add("TextInput_disabled"),e.setAttribute("disabled",!0),e.setAttribute("tabindex",-1))}))}));var r=(0,p.$)("input",a);r&&n&&r.focus(),(0,u.setStyle)(e,{height:a?a.clientHeight:0})}}function W(e){var t=(0,p.$)(".ShareModal");t&&t.classList.toggle("ShareModal--disableAnimations",!e)}function N(e){if(cur.share){var t=cur.share._els,n=t.header,a=t.content,o=t.bottom;a.classList.add("ShareLists--transition"),W(!0),$(n,e?"ShareHeaderGroupsPanel":"ShareHeaderConversationsPanel"),$(a,e?"ShareGroups":"ShareConversations"),$(o,e?"":"ActionsPanel"),setTimeout((function(){a.classList.remove("ShareLists--transition")}),300),(0,p.$)(".SharePanel--active ul",a).focus(),R(),B(e?(0,p.$)("#ShareGroups .ShareList__container"):(0,p.$)("#ShareConversations .ShareList__container"))}}function F(e){if(cur.share){var t=cur.share._els,n=t.header,a=t.bottom,o=Y();L=e,W(!1),$(a,e?"":o),e&&$(n,"ShareHeaderConversationsSearchPanel",!0),!m.isIOS&&window.innerWidth<g.DESKTOP_WIDTH&&R(e),setTimeout((function(){browser.ios&&(0,u.scrollTop)(document.activeElement)}),500)}}function G(){if(cur.share){var e=cur.share._els,t=e.content,n=e.bottom,a=e.messageTextarea;$(n,"ExpandedMessagePanel"),t.classList.add("ShareLists--transition"),m.isIOS||R(!1),a.focus({preventScroll:!0})}}function j(e){if(void 0===e&&(e=!0),cur.share){var t=cur.share,n=t.selected,a=t._els;(0,u.ge)(P)&&(!function(){if(!cur.share)return;var e=cur.share.cache._cache,t=(0,p.$)(".ShareHeaderConversationsPanel"),n=(0,p.$)(".ShareHeaderConversationsPanel .SharePanel-headerText__receivers",t),a=cur.share.selected,o=a.length;t.classList.toggle("ShareHeaderConversationsPanel--hasReceivers",o>0);var r="";if(1===o){r=(0,d.getLang)("mobile_share_box_to_single");var i=e[a[0]][0];r=r.replace("{name}",i)}else if(2===o){r=(0,d.getLang)("mobile_share_box_to_couple");var s=e[a[0]][6]||e[a[0]][0],l=e[a[1]][6]||e[a[1]][0];r=r.replace("{name1}",s).replace("{name2}",l)}else if(o>2){r=(0,d.getLang)("mobile_share_box_to_many");var c=e[a[0]][6]||e[a[0]][0];r=r.replace("{name}",c).replace("{count}",o-1)}n.innerHTML=r}(),D());var o,r,i=Y();$(a.bottom,i,e),o=n.length>1,r=cur.share._els.messagePanel,(0,p.$)(".Btn",r).innerHTML=o?(0,d.getLang)("mobile_share_message_many"):(0,d.getLang)("mobile_share_message_single")}}function Y(){if(cur.share){var e=cur.share,t=e.selected,n=e.content,a=(0,p.$)(".SharePanel--active",n).getAttribute("data-name");return"ShareHeaderGroupsSearchPanel"===a||"ShareHeaderGroupsPanel"===a?"":document.activeElement&&document.activeElement.closest(".ExpandedMessagePanel")?"ExpandedMessagePanel":t.length>0?"MessagePanel":"ActionsPanel"}}function R(e){if(cur.share&&cur.share._els){var t=cur.share._els,n=t.header,a=t.bottom,o=t.content,r=t.groupsList;if(n&&a&&o){var i=400;(e=L||e)&&(i+=cur.share.lastBottomHeight-(0,u.getH)(a)),a.clientHeight&&(cur.share.lastBottomHeight=a.clientHeight);var s=[n,a].reduce((function(e,t){var n=(0,p.$)(".SharePanel--active",t);return n&&(e+=n.clientHeight,(0,u.setStyle)(t,{height:n.clientHeight})),e}),0),l=Math.min(i,(0,u.getCh)()-s),c=s+l!==E;c||(W(!1),o.classList.remove("ShareLists--transition")),(0,u.setStyle)(r,{bottom:-a.clientHeight}),(0,u.setStyle)(o,{height:l}),c||W(!0),E=s+l}}}function D(){cur.share&&(0,u.each)((0,u.geByClass)("inline_item",(0,p.$)("ShareConversations__container")),(function(e,t){if(cur.share){var n=(0,u.intval)((t.id||"").substr(4)),a=-1!==cur.share.selected.indexOf(n);(0,u.toggleClass)("inline_item_selected",t,a),t.setAttribute("aria-selected",a);var o=(0,p.$)('input[type="checkbox"]',t);o&&(o.checked=a)}}))}function K(e){var t=cur.share._els.bookmarkButton;if(t){var n=(0,p.$)(".ActionsPanel-button__icon",t),a=(0,p.$)(".ActionsPanel-button__label",t);t.setAttribute("aria-pressed",e),e?(n.innerHTML=Wd.html((0,w.Icon28Favorite)()),a.innerHTML=(0,d.getLang)("mobile_share_target_bookmark_active")):(n.innerHTML=Wd.html((0,w.Icon28FavoriteOutline)()),a.innerHTML=(0,d.getLang)("mobile_share_target_bookmark")),window.thover.clear()}}function z(e){var t=cur.share._els,n=t.bottom,a=t.processingPanel,o=this.mail_hash,r=this.object,s=this.list,l=this.appId,c=this.shouldInteractWithGlobalStories,h={_ajax:1,from:"share_box",hash:o,list:s,message:(0,p.$)(".ExpandedMessagePanel__textareaWrap textarea").value,to:cur.share.selected.join(","),app_id:l,ref:H(r)};(0,v.isValidAttachment)(cur.share.options.object)?h.media=r:h.link=r,W(!0),e&&(0,u.cancelEvent)(e),$(n,"ProcessingPanel"),cur.share.blocked=!0,(r.startsWith("story")||r.startsWith("narrative"))&&!1!==c&&window.Stories.sendAnalyticsEvent("share_to_message"),setTimeout((function(){R()})),setTimeout((function(){R()}),350),window.ajax.post("/mail?act=send",h,{onDone:function(e){W(!0);var t=(0,p.$)(".ProcessingPanel__icon",a),n=(0,p.$)(".ProcessingPanel__label",a);t.classList.remove("ProcessingPanel__icon--loading");var o=e.error;t.innerHTML=Wd.html(o?(0,i.default)((0,M.getErrorCircle40Icon)()):(0,i.default)((0,S.getDoneCircle40Icon)())),n.innerText=o?(0,d.getLang)("mobile_share_state_error"):(0,d.getLang)("mobile_share_state_success"),setTimeout((function(){cur.app&&(o&&cur.app.hasOwnProperty("vkMiniAppShareFail")?cur.app.vkMiniAppShareFail():!o&&window.isFunction(cur.app.vkMiniAppShareSuccess)&&cur.app.vkMiniAppShareSuccess(0)),cur.share&&cur.share.destroy({isFail:o})}),1e3)}})}function X(e,t,n){void 0===n&&(n=!1),(0,u.preventEvent)(e);var a,o,r,i=cur.share._els.header;if("group"===t?(a=(0,u.ge)("ShareHeaderGroupsSearchPanel__input"),o="ShareHeaderGroupsPanel",r=cur.shareGroupSearch):"peers"===t&&(a=(0,u.ge)("ShareHeaderConversationsSearchPanel__input"),o="ShareHeaderConversationsPanel",r=cur.shareSearch),W(!1),a.value){if(n)return void W(!0);r.clear()}else"peers"===t?($(i,o),F(!1)):($(i,o),W(!0))}function q(){var e,t=cur.share.options.object,n="unknown";if((0,v.isValidAttachment)(cur.share.options.object)){e=/^([a-z_]+)(-?\d+)_(\d+)$/.exec(cur.share.options.object),n=e[1];var a=e[2],o=e[3];"app"===n&&"0"===o&&(t="app"+a),cur.share.options.list&&(t+="?list="+cur.share.options.list),t=t.replace("wall_reply","wall")}else cur.share.options.isVKApp&&(n="link");t=cur.share.options.external_url||t;var r=navigator.share({url:t});if(!r)return(0,u.statlogsValueEvent)("mvk_share_external",n);r.then((function(){cur.share&&(0,u.statlogsValueEvent)("mvk_share_external",n)}))}function U(e,t,n){var a=e.split("_"),o=31,r=5,i=6,s=[o,r,3,i].includes((0,u.toInt)(t.bookmark_type)),l=[2,i].includes(t.bookmark_type);if(window.ajax.post("/bookmarks.php",{_ajax:1,from:"share_box",wide:l?1:0,star:s?1:0,act:t.is_bookmarked?"bookmark_remove":"bookmark_add",item_type:t.bookmark_type,item_oid:a[0],item_id:a[1],hash:t.bookmark_hash,link_url:t.link_url,link_title:t.link_title,link_img:t.link_img,ref:H(e)},{onDone:function(e,t,n,a,r){var i=(0,p.$)("."+e),s=(0,u.ceFromString)(t);i&&(0,u.replace)(s,i.parentNode),n&&n.item_type===o&&r&&(0,k.sendNarrativeAnalytic)(k.NarrativeAnalyticEventType.addToBookmarks,{ownerId:n.item_oid,id:n.item_id},k.NarrativeAnalyticNavScreen.storyViewer)}}),t.bookmark_type===r&&window.Article.toggleButton(e,!t.is_bookmarked),t.bookmark_type===o&&!1!==t.shouldInteractWithGlobalStories){var c=(0,p.$)(".StoryMenu__button");window.Stories.toggleBookmark(c,!0)}t.is_bookmarked=!t.is_bookmarked,A.bookmarks[e]=t.is_bookmarked,n()}function Q(){R(!1)}function J(e,t){A.bookmarks[e]=t}t.default=function(e,t,n){var g=t.can_to_own,w=void 0===g||g,S=t.can_to_club,M=void 0===S||S,k=t.can_bookmark,E=t.is_bookmarked,L=t.from,B=t.post_from,Y=t.list,J=t.targetOwnOnClick,Z=t.appId,ee=t.isVKApp;cur.share&&cur.share.destroy();var te=!(0,v.isValidAttachment)(t.object);if(!te||ee){te&&!/^(https|http)?:\/\//i.test(t.object)&&(t.object="https://"+e,e=t.object),o.default&&o.default.close(),t.withoutScrollView||(0,c.preventDocumentScroll)(),te||(E=void 0!==A.bookmarks[e]?A.bookmarks[e]:E,t.is_bookmarked=E),(0,u.cancelEvent)(n);var ne=!!navigator.share,ae=browser.ios?"iOS":"Android",oe=(0,a.default)({on_overlay_click:"cur.share && cur.share.destroy()",class:"ShareModal",attached:!0,body:(0,r.default)({targetOwnOnClick:J||null,can_to_own:w,can_to_club:M,supportsExternalShare:ne,platform:ae,can_bookmark:k,is_bookmarked:E,list:Y,from:L,post_from:B,object:t.object,isVKApp:t.isVKApp})}),re=t.withoutHash?null:"share";a.default.open(Wd.elem(oe),!0,re,{swipeDown:!0,onClose:function(){cur.share&&cur.share.destroy({closeModal:!1})}});var ie=(0,p.$)(".ShareModal"),se=(0,p.$)(".ShareHeader"),le=(0,p.$)(".ShareLists"),ce=(0,p.$)(".ShareBottom"),ue=(0,p.$)(".ActionsPanel-button--bookmark"),de=(0,p.$)(".ActionsPanel-button--group");setTimeout((function(){!function(e){void 0===e&&(e={});cur.shareSearch=new window.QuickSearch;var t=e.appId?x+"&app_id="+e.appId:x,n=e.appId?x+"&app_id="+e.appId+P:C;cur.shareSearch.init({action:t,field:"ShareHeaderConversationsSearchPanel__input",container:P,top_len:20,onFocusChanged:function(e){e?_.onOpen("top"):_.onClose(),R(e),setTimeout((function(){R(e)}),200)},tpl:function(e,t){return'<ul aria-multiselectable="true" aria-hidden="false" class="ScrollView ShareConversations__container ShareList__container" onscroll="cur.share.onScroll(this)">'+e+"</ul>"},item_tpl:function(e,t){if(cur.share){var n=cur.share.cache._cache,a=n[this.id][0],o=!(!n[this.id][8]||!n[this.id][8].is_casper)?'<span class="ShareConversationsCasperTitle">\n             <span class="ShareConversationsCasperTitle__text">'+this.highlight(a)+'</span>\n             <span class="ShareConversationsCasperTitle__icon">'+Wd.html((0,i.default)((0,b.getCasper16Icon)()))+"</span>\n           </span>":this.highlight(a),r=-1!==cur.share.selected.indexOf(+this.id)?"inline_item_selected":"",s=Wd.html((0,y.Avatar)({mode:(0,d.getAvatarMode)({id:this.id,name:a}),backgroundTheme:this.id,text:a,textLength:(0,d.getAvatarTextLength)(this.id),src:t,size:44,mix:"ii_img",attrs:{"aria-hidden":"true"}}));return'\n        <label aria-label="'+a+'" tabindex="0" role="checkbox" id="peer'+this.id+'" onclick="cur.share.select('+this.id+', this)" class="inline_item active '+r+'">\n          <input type="checkbox" style="display: none;">\n            '+s+'\n            <div class="ii_body">\n              <div class="ii_owner">\n                 '+o+"\n              </div>\n            </div>\n          </input>\n        </label>\n      "}},null_tpl:function(e){var t=(0,d.getLang)("mobile_friends_search_not_found").replace("%s",(0,u.htsc)(e));return e||(t=(0,d.getLang)("mobile_share_list_no_friends")),'<div class="service_msg_box"><div class="service_msg service_msg_null">'+t+"</div></div>"}}),cur.share.cache=window.QuickSearchCache[n],D()}({appId:Z})}),250),(0,u.addEvent)(ue,"click",U.bind(this,e,t,(function(){K(t.is_bookmarked)})),{passive:!0}),(0,u.addEvent)(de,"click",(function(){N(!0)}),{passive:!0});var he=(0,p.$)(".ExpandedMessagePanel textarea"),ve=(0,p.$)(".MessagePanel__input input");he.value=t.message||"",ve.value=t.message||"",(0,l.initAutogrow)(he),(0,u.addEvent)(he,"input blur focus",(function(e){var t=cur.share._els.content;ve.value=he.value.replace(/\n/gi," "),W(!1),"input"===e.type&&R(!1),"focus"===e.type&&(t.classList.remove("ShareLists--transition"),ie.classList.add("ModalMenu--blocked"),ie.classList.add("ModalMenu--focused"),_.onOpen("bottom"),setTimeout((function(){j(!0),W(!1),R()}),100)),"blur"===e.type&&(ie.classList.remove("ModalMenu--blocked"),e.preventDefault(),e.stopPropagation(),_.onClose(),W(!1),ie.classList.remove("ModalMenu--focused"),m.isIOS||R(!1),setTimeout((function(){j(!1),W(!1),R()}),100))})),(0,u.addEvent)((0,p.$)(".ExpandedMessagePanelSend"),"click touchend",(function(e){e.stopPropagation(),e.preventDefault(),document.activeElement&&document.activeElement.blur(),cur.share.sendMessage()}),{capture:!0}),(0,u.addEvent)(he,"touchmove",(function(e){(0,u.stopEvent)(e)}),{capture:!0}),_.onCloseCallback(Q),(0,u.addEvent)(he,"keydown",(function(e){13===e.keyCode&&(e.ctrlKey||e.metaKey&&browser.mac)&&cur.share.sendMessage(e)}));var pe={act:"publish_box",object:"null"};Z&&(pe.app_id=Z),t.object?(pe.object=t.object,t.list&&(pe.list=t.list)):te&&(pe.link=e,delete pe.object);var fe=(0,f.makeUrl)("/like",pe);cur.share={open:!0,onClose:(0,h.default)(),go:I,options:t,externalShare:q,actionBox:fe,blocked:!1,updateHeights:R,_els:{actionsPanel:(0,p.$)(".ActionsPanel"),messagePanel:(0,p.$)(".MessagePanel"),processingPanel:(0,p.$)(".ProcessingPanel"),groupsList:(0,u.ge)("ShareGroups"),conversationsList:(0,u.ge)("ShareConversations"),bookmarkButton:ue,messageTextarea:he,header:se,content:le,bottom:ce},selected:[],expandMessage:G,toggleGroupsPanel:N,toggleConversationsSearch:F,select:V,clearSearch:X,setActivePanel:$,onScroll:O,sendMessage:z.bind(t),lastBottomHeight:ce.clientHeight,destroy:function(e){void 0===e&&(e={}),e=(0,u.extend)({closeModal:!0,isFail:!0,isNavigation:!1},e),_.offCloseCallback(Q);var t=(0,p.$)(".ShareModal");e.isFail&&cur.app&&cur.app.vkMiniAppShareFail&&cur.app.vkMiniAppShareFail(),t&&e.closeModal&&a.default.close(t),cur.share&&(cur.share.onClose(e.isNavigation),cur.share.open=!1),cur.share.options.withoutScrollView||(0,c.restoreDocumentScroll)(),delete cur.share,delete cur.shareSearch,delete cur.shareGroupSearch}},J&&"function"==typeof J&&(cur.share.toOwnWall=J),setTimeout((function(){!function(){cur.shareGroupSearch=new window.QuickSearch;var e=Wd.html((0,s.default)({icon:"chevron_right"}));if(!cur.share||!cur.share.options.can_to_club)return;cur.shareGroupSearch.init({load_once:!0,field:"ShareHeaderGroupsSearchPanel__input",container:T,action:cur.share.actionBox,onFocusChanged:function(e){e?_.onOpen("top"):_.onClose(),setTimeout((function(){R(!1)}),100)},tpl:function(e,t){return'<ul aria-hidden="true"  class="ScrollView ShareGroups__container ShareList__container" onscroll="cur.share.onScroll(this)">'+e+"</ul>"},item_tpl:function(t,n){if(!cur.share)return"";var a=function(){if(!cur.share)return{};var e=cur.share.actionBox+T;return window.QuickSearchCache[e]}()._cache[this.id][0],o=cur.share.options,r=o.object,i=o.list,s=o.from,l=o.post_from,c={act:"add",share_box:"1",ref:H(r)};r&&(c=(0,u.extend)(c,{object:r,list:i,from:s,post_from:l})),cur.share.options.isVKApp&&(c.is_vk_app=+cur.share.options.isVKApp);var h=(0,f.makeUrl)("/wall"+this.id,c),v=Wd.html((0,y.Avatar)({mode:(0,d.getAvatarMode)({id:this.id,name:a}),backgroundTheme:this.id,text:a,textLength:(0,d.getAvatarTextLength)(this.id),src:n,size:44,mix:"ii_img",attrs:{"aria-hidden":"true"}}));return'\n        <li aria-label="'+a+'" tabindex="0" role="link" id="group'+this.id+'" onclick="cur.share.go(\''+h+"', "+cur.share.options.isVKApp+')" class="inline_item " xmlns="http://www.w3.org/1999/html">\n          '+v+'\n          <div class="ii_body">\n            <div class="ii_owner">\n               '+this.highlight(a)+'\n            </div>\n            <div class="ii_go">\n               '+e+"\n            </div>\n          </div>\n        </li>\n      "},null_tpl:function(e){var t=(0,d.getLang)("mobile_groups_no_groups_found");return e||(t=(0,d.getLang)("mobile_share_list_no_groups")),'<div class="service_msg_box"><div class="service_msg service_msg_null">'+t+"</div></div>"}})}()}),300),K(E),R(),se.closest(".Share").focus(),window.onBodyResize((function(){document.activeElement&&"INPUT"===document.activeElement.tagName?R(!0):R(!1),setTimeout((function(){W(!0)}),150)})),window.onBodyResize(!0)}else console.warn("Can't share link outside miniapp")}},56804:function(e,t,n){"use strict";n.d(t,{init:function(){return r.default}});var a=n(9046),o=n(32128),r=n(76470);window.Share=r.default,(0,a.extend)(window.Share,{setBookmarkState:r.setBookmarkState});o.default},94490:function(e,t,n){"use strict";n.d(t,{Gesture:function(){return a}});var a=function(){function e(e){this.lastTime=0,this.lastRegisteredTime=0,this.lastCoordinates=[0,0],this.velocity={x:0,y:0},this.lastTime=e.time,this.lastCoordinates=[e.x,e.y],this.velocity={x:0,y:0}}return e.getVelocity=function(e,t,n){return{x:t/e||0,y:n/e||0}},e.prototype.registerEvent=function(t){if("touchmove"===t.type){var n=+t.touches[0].clientX,a=+t.touches[0].clientY,o=t.timeStamp-this.lastTime;if(t.timeStamp-this.lastRegisteredTime<=16.67)this.lastCoordinates=[n,a],this.lastTime=t.timeStamp;else{var r=n-this.lastCoordinates[0],i=a-this.lastCoordinates[1];this.velocity=e.getVelocity(o,r,i),this.lastTime=t.timeStamp,this.lastRegisteredTime=this.lastTime,this.lastCoordinates=[n,a]}}else window.clog&&window.clog("[Gestures.js] unhandled event "+t.type)},e}()},84006:function(e,t,n){"use strict";function a(e){return/^((?:([a-z]+)_)?([a-z_]+))(-?\d+)?(?:_(\d+))?$/.test(e)}n.d(t,{isValidAttachment:function(){return a}})},40469:function(e,t,n){"use strict";n.d(t,{NarrativeAnalyticEventType:function(){return a},NarrativeAnalyticNavScreen:function(){return o},sendNarrativeAnalytic:function(){return s}});var a,o,r=n(86900),i=n(86353);function s(e,t,n){var a;void 0===n&&(n=o.other);var s=(null==t?void 0:t.title)||void 0,l=(null==t?void 0:t.customCover)?0:(null==t?void 0:t.coverStoryId)||0,c=(null==t?void 0:t.id)||0,u=(null==t?void 0:t.ownerId)||0,d=null===(a=null==t?void 0:t.stories)||void 0===a?void 0:a.map((function(e){return e.id})),h={event_type:e,nav_screen:n,narrative_owner_id:u,narrative_id:c,narrative_title:s,story_ids:(null==d?void 0:d.length)?d:void 0,cover_story_id:l};(0,r.statlogsValueEvent)("narrative_product_analytic",h),(0,i.partConfigEnabled)("narratives_web_analytic_debug")&&console.log("-- narrative analytic",h)}!function(e){e.clickToAddToNarrative="click_to_add_to_narrative",e.addStoryToNarrative="add_story_to_narrative",e.openNarrativeList="open_narrative_list",e.close="close",e.changeSort="change_sort",e.publishNarrative="publish_narrative",e.createNarrative="create_narrative",e.deleteNarrative="delete_narrative",e.clickToEditNarrative="click_to_edit_narrative",e.editNarrative="edit_narrative",e.addToBookmarks="add_to_bookmarks",e.shareNarrative="share_narrative",e.seeMore="see_more",e.addToNarrativeFromActionSheet="add_to_narrative_from_action_sheet"}(a||(a={})),function(e){e.storyArchive="story_archive",e.storyViewer="story_viewer",e.profile="profile",e.feedBlock="narratives_feed_block",e.club="club",e.other="other"}(o||(o={}))}}]);