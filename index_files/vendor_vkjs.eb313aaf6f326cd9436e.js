/*! For license information please see vendor~vkjs.eb313aaf6f326cd9436e.js.LICENSE.txt */
(self.webpackChunkvk=self.webpackChunkvk||[]).push([[6855],{53369:function(e,r,t){"use strict";t.d(r,{api:function(){return s},setApiConfig:function(){return a}});var n=t(46042),o={domain:"api.vk.com",maxRetries:10},i=new Map;function a(e){e=Object.assign({},o,e),o=e}function s(e,r,t,c){void 0===c&&(c={});var u=o;t&&(u=Object.assign({},o,t));var d,p,f=u.domain,h=(0,n.m)((p={v:(d=u).version||"5.123"},d.appId&&(p.client_id=d.appId),p)),m=function(e){return{access_token:e.accessToken}}(u),g="https://"+f+"/method/"+e+"?"+h,_=Object.assign({},r,m),v=function(e,r){return e+"-"+(0,n.m)(r)}(g,_),l=i.get(v)||0;return new Promise((function(e){var r=function(e){if(0===e)return 0;var r=Math.random(),t=100*Math.pow(2,e)/2;return t+t*r}(l);setTimeout((function(){return e()}),r)})).then((function(){return(0,n.c)(g,_,c)})).then((function(n){if(n.response)return l&&i.delete(v),n.response;var o=n.error;if(!o)return Promise.reject({type:"api_error",error:{error_code:0,error_msg:"Unknown"}});if(u.onCaptcha&&14===o.error_code){var c=o,d=c.captcha_sid,p=c.captcha_img;return u.onCaptcha({captcha_sid:d,captcha_img:p}).then((function(n){var o=Object.assign({},r,n);return s(e,o,t)}))}return u.maxRetries&&l>=u.maxRetries?(l&&i.delete(v),Promise.reject({type:"api_error",error:{error_code:0,error_msg:"Maximum of api retries exceeded"}})):!u.onTokenExpired||t&&t.accessToken||5!==o.error_code?Promise.reject({type:"api_error",error:n.error}):u.onTokenExpired().then((function(n){return i.set(v,l+1),a({accessToken:n}),s(e,r,t)}))}),(function(e){return Promise.reject({type:"network_error",error:e})}))}},72962:function(e,r,t){"use strict";t.d(r,{Embedded:function(){return n}});var n=function(){function e(e){var r=this;this.receiver=!1,this._requestId=1,this._requests={},this._onMessage=function(e){if(e.origin===r.origin&&e.data&&e.data.embeddedName===r.name){r.target=e.source;var t=e.data,n=t.response;if(n){var o=r._requests[n];o&&o(t.data),r._requests[n]=null}else t.request&&t.action&&Promise.resolve(r.onMessage(t.action,t.data)).then((function(e){r._sendResponse(t.request,t.action,e)}))}},this.name=e.name,this.target=e.target,this.origin=e.origin||"https://"+e.host,this.receiver=e.receiver||!1,this.onMessage=e.onMessage,window.addEventListener("message",this._onMessage,!1)}return e.prototype._sendResponse=function(e,r,t){this.target&&this.target.postMessage({embeddedName:this.name,action:r,response:e,data:t},this.origin)},e.prototype.sendMessage=function(e,r){var t=this;if(void 0===r&&(r={}),!this.target)return Promise.reject();var n=this._requestId,o=new Promise((function(e){t._requestId++,t._requests[n]=e}));return this.target.postMessage({embeddedName:this.name,action:e,data:r,request:n},this.origin),o},e.prototype.destroy=function(){window.removeEventListener("message",this._onMessage,!1),this.target=void 0},e}()},98374:function(e,r,t){"use strict";t.d(r,{login:function(){return p},removeLoginCache:function(){return f},setLoginConfig:function(){return a}});var n=t(46042),o=/\d+:[a-zA-Z_]+:login:auth/,i={domain:"login.vk.com"};function a(e){e=Object.assign({},i,e),i=e}var s,c,u={},d={};function p(e,r,t,o,a){var s;void 0===a&&(a={});var c=i;t&&(c=Object.assign({},i,t));var h,m=c.appId+":"+e+":login:auth",g=!d[m]||o;try{h=JSON.parse(localStorage.getItem(m))}catch(l){h={}}if(u[m])return u[m];if(g)try{f(e,t)}catch(l){}else{var _=void 0;try{_=localStorage.getItem(m)}catch(l){console.error(l)}if(_)try{var v=JSON.parse(_);if(1e3*Number(v.expires)-Date.now()>=6e4)return Promise.resolve(v);f(e,t)}catch(l){}}var l,y=c.domain,I=c.onCaptcha,O="https://"+y+"/?act="+e,b={version:(l=c).version||"1",app_id:l.appId},j=Object.assign({},r,b,{access_token:null==h?void 0:h.access_token});return s=(0,n.c)(O,j,a).then((function(o){if(delete u[m],"error"===o.type)return Promise.reject({type:"login_error",error:o.error_info});if("captcha"===o.type){if(!I)return Promise.reject({type:"login_error",error:"captcha"});var i=o.captcha_sid,a=o.captcha_img,s=o.captcha_type;return I({captcha_sid:i,captcha_img:a,captcha_type:s}).then((function(n){var o=Object.assign({},r,n);return p(e,o,t)}))}var c=o.data.expires||1/0;try{localStorage.setItem(m,JSON.stringify((0,n._)((0,n._)({},o.data),{expires:c})))}catch(o){console.error(o)}return d[m]=!0,o.data}),(function(e){return delete u[m],{type:"network_error",error:e}})),u[m]=s,s}function f(e,r){if(e){var t=i;r&&(t=Object.assign({},i,r));var n=t.appId+":"+e+":login:auth";try{localStorage.removeItem(n)}catch(e){}}else try{Object.keys(localStorage).forEach((function(e){o.test(e)&&localStorage.removeItem(e)}))}catch(e){}}(c=s||(s={})).PASSWORD_CONFIRMATION_REQUIRED="password_confirmation_required",c.PHONE_VALIDATION_REQUIRED="phone_validation_required",c.USER_ALREADY_HAS_EXTERNAL_BINDING="user_already_has_external_binding"},46042:function(e,r,t){"use strict";t.d(r,{_:function(){return n},a:function(){return o},c:function(){return a},m:function(){return i}});var n=function(){return(n=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function o(e,r){var t=i(r),n=e.includes("?");return e+(n?"&":"?")+t}function i(e){return Object.keys(e).map((function(r){var t=e[r];return(r=encodeURIComponent(r||""))+"="+encodeURIComponent(t||"")})).join("&")}function a(e,r,t){void 0===t&&(t={});var o=i(r);return fetch(e,n({method:"POST",body:o,mode:"cors",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"}},t)).then((function(e){return e.json()}))}}}]);